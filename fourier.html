<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2019-10-13 Sun 18:49 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MoreLinear \\ Fourier</title>
<meta name="generator" content="Org mode">
<meta name="author" content="George Kontsevich">
<meta name="description" content="linear algebra methods in Clojure"
>
<link rel="stylesheet" type="text/css" href="../web/worg.css" />
<link rel="shortcut icon" href="../web/panda.svg" type="image/x-icon">
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="./index.html"> UP </a>
 |
 <a accesskey="H" href=".."> HOME </a>
</div><div id="content">
<h1 class="title">MoreLinear \\ Fourier</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org38d04ed">Goal</a></li>
<li><a href="#org83d372f">Complex numbers</a></li>
<li><a href="#orgea842ef">The Unit Circle</a></li>
<li><a href="#orgd85ac2f">Euler's Formula</a></li>
<li><a href="#org0d9c3b2">The roots of unity</a></li>
<li><a href="#orgc11849a">Fourier series</a></li>
<li><a href="#org7f287d5">Inner products of complex numbers</a></li>
<li><a href="#org8c69c8d">Fourier Vectors</a></li>
<li><a href="#orgd91bc90">Fourier Matrix</a></li>
<li><a href="#orgf4121b8">Frequency Space?</a>
<ul>
<li><a href="#orgaf2d678">How does a sinusoidal look in this basis?</a></li>
<li><a href="#org6e18e17">How does a phase shift look in this basis?</a></li>
<li><a href="#org48a6b11">How does a frequency who's period isn't a whole fraction of the sample rate come out in this basis?</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org38d04ed" class="outline-2">
<h2 id="org38d04ed">Goal</h2>
<div class="outline-text-2" id="text-org38d04ed">
<p>
Using the multiplicative properties of complex numbers we find a way to construct an convenient, easily-invertible orthogonal basis. This basis allows us to represent a series of input samples (ie. in an input vector) as the sum of a carefully constructed, independent set of sinusoidals. This basis allows us to carry out a class of operations that are numerically intensive in the standard basis but much quicker in the frequency-basis.
</p>
</div>
</div>

<div id="outline-container-org83d372f" class="outline-2">
<h2 id="org83d372f">Complex numbers</h2>
<div class="outline-text-2" id="text-org83d372f">
<p>
Complex numbers are of the form <b>a+ib</b> where <b>i= &radic;(-1)</b> and the factor <b>b</b> is known as the imaginary component of the complex number. The pair (a,b) are often referred to as a point on the complex plane.
</p>

<p>
They have some properties which make they act like 2D coordinates with the <i>real</i> component <b>a</b> acting as the <i>x</i> and the <i>imaginary</i> component <b>b</b> acting as the <i>y</i>:
</p>
<ul class="org-ul">
<li>(a+ib) + (c+id) = (a+c) + i(bd)</li>
<li>c * (a+ib) = ca +icb</li>
</ul>

<p>
However unlike 2D [x,y] coordinates, complex numbers can be multiplied:
</p>
<ul class="org-ul">
<li>(a+ib) * (c+id) = (ac-bd) + i(ad+bc)</li>
</ul>

<p>
In the [x,y] case multiplication is simply no defined (though you can do dot products and cross products). So points in the complex plane have this extra "feature". As far as I can tell there is no easy way to visualize what the result is for the general case
</p>
</div>
</div>

<div id="outline-container-orgea842ef" class="outline-2">
<h2 id="orgea842ef">The Unit Circle</h2>
<div class="outline-text-2" id="text-orgea842ef">
<p>
Given two points on the unit circle (ie. all points who's lenght is equal to 1) we can safely write:
</p>
<ul class="org-ul">
<li>(a<sup>2</sup>+b<sup>2</sup>)<sup>1/2</sup> = 1 <i>and therefore</i> a<sup>2</sup>+b<sup>2</sup> = 1</li>
<li>(c<sup>2</sup>+d<sup>2</sup>)<sup>1/2</sup> = 1 <i>and therefore</i> c<sup>2</sup>+d<sup>2</sup> = 1</li>
</ul>
<p>
As we saw, their product is the point <i>(ac-bd) + i(ad+bc)</i> and its length is:
</p>
<ul class="org-ul">
<li>[ (ac-bd)<sup>2</sup> + (ad+bc)<sup>2</sup> ]<sup>(1/2)</sup></li>
<li>[ a<sup>2</sup>c<sup>2</sup>-2acbd+b<sup>2</sup>d<sup>2</sup>+a<sup>2</sup>d<sup>2</sup>+2adbc+b<sup>2</sup>c<sup>2</sup> ]<sup>1/2</sup></li>
<li>[ a<sup>2</sup>c<sup>2</sup>+b<sup>2</sup>b<sup>2</sup>+a<sup>2</sup>d<sup>d</sup>+b<sup>2</sup>c<sup>2</sup> ]<sup>1/2</sup></li>
<li>[ c<sup>2</sup>(a<sup>2</sup>+b<sup>2</sup>) + d<sup>2</sup>(a<sup>2</sup>+b<sup>2</sup>) ]<sup>(1/2)</sup></li>
</ul>
<p>
Here we can substitute in our equations for the 2 points to see that the length of the product is also equal to 1.
</p>

<p>
So while the general case is hard to think about, we can at least say that the product of any two points on the unit circle gives us a new point on the unit circle
</p>
</div>
</div>

<div id="outline-container-orgd85ac2f" class="outline-2">
<h2 id="orgd85ac2f">Euler's Formula</h2>
<div class="outline-text-2" id="text-orgd85ac2f">
<p>
Combining the definition of <i>sine</i> and <i>cosine</i> with pythagoras' theorem (for the case where the hypotenous is equal to one) gives us the trigonometric identity:
</p>
<ul class="org-ul">
<li>cos<sup>2</sup>(&theta;)+sin<sup>2</sup>(&theta;) = 1</li>
</ul>

<p>
Euler's formula tells us that: <b>(TODO: Exapand on this)</b>
</p>
<ul class="org-ul">
<li>e<sup>i&theta;</sup>=cos(&theta;)+isin(&theta;)</li>
</ul>

<p>
Which allows us to safely say that the length of <i>e<sup>i&theta;</sup></i> in the "complex plane" is always equal to <i>1</i>. And in fact all points on the unit cirlce can be described with Euler's formula. 
As was shown in the previous section, this means:
</p>
<ul class="org-ul">
<li>|| e<sup>i&theta;</sup> * e<sup>i&omega;</sup> || = 1</li>
</ul>
<p>
You can see this either by substituing in the sine/cosine and viewing it as the product of two complex numbers, or you can add the exponent  <i>e<sup>i(&theta;+&omega;)</sup></i> and reusing the trigonometric identity.
</p>

<p>
Now notice that if <i>&omega;=2&pi;-&theta;</i> that:
</p>
<ul class="org-ul">
<li>e<sup>i(&theta;+&omega;)</sup> = e<sup>i2&pi;</sup> = cos(2&pi;) + isin(2&pi;) = 1 + i0 = 1</li>
</ul>

<p>
Also note that complex conjugate of 
</p>
<ul class="org-ul">
<li>e<sup>i&theta;</sup>=cos(&theta;)+isin(&theta;)</li>
</ul>
<p>
is
</p>
<ul class="org-ul">
<li>cos(&theta;)-isin(&theta;)</li>
</ul>
<p>
Using the trigonometric properties (which are self evident if you think of the graph and even/odd functions)
</p>
<ul class="org-ul">
<li>sin(-&theta;)=-sin(&theta;)</li>
<li>cos(-&theta;)= cos(&theta;)</li>
</ul>
<p>
We can rewrite the conjugate as
</p>
<ul class="org-ul">
<li>cos(-&theta;) + isin{-&theta;) = e<sup>-&theta;</sup></li>
</ul>
</div>
</div>

<div id="outline-container-org0d9c3b2" class="outline-2">
<h2 id="org0d9c3b2">The roots of unity</h2>
<div class="outline-text-2" id="text-org0d9c3b2">
<p>
Furthermore if <i>&alpha;=2&pi;/n</i> then:
</p>
<ul class="org-ul">
<li>[e<sup>i&alpha;</sup>]<sup>n</sup> = e<sup>in&alpha;</sup> = e<sup>i2&pi;</sup> = 1</li>
</ul>
<p>
This tells us that taking the n<sup>th</sup> root of <i>1</i> has a complex numbers solution! (in addition to the trivial solution of <i>1</i>)
</p>
<ul class="org-ul">
<li>1<sup>1/n</sup> = e<sup>i2&pi;/n</sup></li>
</ul>
<p>
The typical notation here is to say 
</p>
<ul class="org-ul">
<li>&xi; = e<sup>-i2&pi;/n</sup></li>
<li>&xi;<sup>n</sup>=1</li>
</ul>
<p>
Then by extension we can also get that:
</p>
<ul class="org-ul">
<li>&xi;<sup>n+j</sup> = &xi;<sup>n</sup>&xi;<sup>j</sup> = &xi;<sup>j</sup></li>
<li>&xi;<sup>nk</sup> = [&xi;<sup>n</sup>]<sup>k</sup> = [e<sup>-i2&pi;</sup>]<sup>k</sup> = 1<sup>k</sup> = 1</li>
</ul>
</div>
</div>

<div id="outline-container-orgc11849a" class="outline-2">
<h2 id="orgc11849a">Fourier series</h2>
<div class="outline-text-2" id="text-orgc11849a">
<p>
for any integer value of <i>k</i> we can write this special sum:
</p>
<ul class="org-ul">
<li>1 + &xi;<sup>k</sup> + &xi;<sup>2k</sup> + &#x2026; + &xi;<sup>(n-2)k</sup> + &xi;<sup>(n-1)k</sup></li>
</ul>
<p>
It has the special property that if it's multiplied by <i>&xi;<sup>k</sup></i> we get the same sequence back b/c the last term goes to <i>&xi;<sup>nk</sup> = 1</i> and the remaining terms in effect shift places
</p>
<ul class="org-ul">
<li>&xi;<sup>k</sup> + &xi;<sup>2k</sup> + &xi;<sup>3k</sup> + &#x2026; + &xi;<sup>(n-1)k</sup> + 1</li>
</ul>
<p>
So we can write
</p>
<ul class="org-ul">
<li>&xi;<sup>k</sup> * <i>fourier-series</i> = <i>fourier-series</i></li>
</ul>
<p>
Therefore
</p>
<ul class="org-ul">
<li>&xi;<sup>k</sup> * <i>fourier-series</i> - <i>fourier-series</i> = 0</li>
<li><i>fourier-series</i> * (&xi;<sup>k</sup> - 1) = 0</li>
</ul>
<p>
And therefore.. 
</p>
<ul class="org-ul">
<li><i>fourier-series</i>  = 0</li>
</ul>
<p>
.. or to write it out again in full form - for all values of <i>k</i>
</p>
<ul class="org-ul">
<li>1+&xi;<sup>k</sup>+&xi;<sup>2k</sup>+&#x2026;+&xi;<sup>(n-2)k</sup>+&xi;<sup>(n-1)k</sup> = 0</li>
</ul>

<p>
While this is an interesting property, we need to leverage this somehow in constructing an orthogonal basis. The sum can be written out in the form:
</p>
<ul class="org-ul">
<li>[ 1 &xi;<sup>k</sup> &xi;<sup>2k</sup> &#x2026; &xi;<sup>(n-1)k</sup> ] [ 1 1 1 &#x2026; 1]<sup>T</sup>= 0</li>
</ul>
<p>
But to form an orthogonal basis we need a set of vectors who's inner product is zero
</p>
</div>
</div>

<div id="outline-container-org7f287d5" class="outline-2">
<h2 id="org7f287d5">Inner products of complex numbers</h2>
<div class="outline-text-2" id="text-org7f287d5">
<p>
The problem is that we don't know how to do inner products with complex numbers yet. Inner products are closely tied to norms and lengths, and the inner product of a vector with itself should give its lengths squared. Using transposition to do an inner product will give us strange results b/c it relies of squaring values to get their positive lengths. However squaring a number like <code>i</code> gives you a <i>negative</i> length which doesn't make too much sense and introduces inconsistencies
</p>

<p>
To do norms of vectors with complex values and to have the whole thing keep working we need to introduce <i>complex conjugates</i> and the idea of a <i>Hermitian transpose</i>. If you have a value <i>a+ib</i> then its complex conjugate is <i>a-ib</i> and it's denoted with a<sup>*</sup>. This value turns out to be useful b/c the product of a complex number and its complex conjugate gives you a real positive number:
</p>
<ul class="org-ul">
<li>(a+ib)(a-ib) = a<sup>2</sup>-i<sup>2b</sup><sup>2</sup> = a<sup>2</sup>+b<sup>2</sup></li>
</ul>
<p>
If we think in terms of coordinates then it's like we're doing pythagoras and getting the length on the complex value on the complex plane. So the answer matches our intuition and when we use these complex conjugates to get the lengths of our roots of unity we will always get back "lengths"/norms of 1.
</p>

<p>
When we deal with vectors we are doing something similar when calculating their 2-norm. Instead of <i>vv<sup>T</sup></i> we now do <i>vv<sup>*</sup></i> where v<sup>*</sup> is the <i>Hermitian transpose</i>. It's like the the normal transpose, but all the vector values are replaced with their complex conjugates:
</p>
<ul class="org-ul">
<li>[ v<sub>1</sub> v<sub>2</sub> v<sub>3</sub> .. v<sub>n</sub> ]<sup>*</sup> = [ v<sub>1</sub><sup>*</sup> v<sub>2</sub><sup>*</sup> v<sub>3</sub><sup>*</sup> .. v<sub>n</sub><sup>*</sup> ]<sup>T</sup></li>
</ul>
<p>
Now we can unroll the inner product sum of <i>vv<sup>*</sup></i>
</p>
<ul class="org-ul">
<li>vv<sup>*</sup>=v<sub>1</sub>v<sub>1</sub><sup>*</sup> + v<sub>2</sub>v<sub>2</sub><sup>*</sup> + v<sub>3</sub>v<sub>3</sub><sup>*</sup> .. v<sub>n</sub>v<sub>n</sub><sup>*</sup></li>
</ul>
<p>
And we see that each product term is giving you a real positive value and the sum is also real and positive - so the 2-norm is always real and positive. Furthermore the Hermetian transpose of a real vector is equal to the normal transpose - so this new extension is "backwards compatible" and works with our purely real systems as well
</p>

<p>
Coming back to our Eurler's forumla, given a &xi;, its complex conjugate is easy to derive using the our trigonometric identities:
</p>
<ul class="org-ul">
<li>&xi;<sup>*</sup> = [cos(&theta;)+isin(&theta;)]<sup>*</sup> = cos(&theta;)-isin(&theta;) = cos(-&theta;)+isin(-&theta;) = &xi;<sup>-1</sup></li>
</ul>

<p>
Given a series of euler exponents we just take the transpose and flip the sign of the exponent;
</p>

<ul class="org-ul">
<li>[ &xi;<sub>1</sub><sup>a</sup> &xi;<sub>2</sub><sup>b</sup> .. &xi;<sub>n</sub><sup>z</sup> ] [ &xi;<sub>1</sub><sup>a</sup> &xi;<sub>2</sub><sup>b</sup> .. &xi;<sub>n</sub><sup>z</sup> ]<sup>*</sup></li>
<li>[ &xi;<sub>1</sub><sup>a</sup> &xi;<sub>2</sub><sup>b</sup> .. &xi;<sub>n</sub><sup>z</sup> ] [ &xi;<sub>1</sub><sup>-a</sup> &xi;<sub>2</sub><sup>-b</sup> .. &xi;<sub>n</sub><sup>-z</sup> ]<sup>T</sup></li>
</ul>
</div>
</div>

<div id="outline-container-org8c69c8d" class="outline-2">
<h2 id="org8c69c8d">Fourier Vectors</h2>
<div class="outline-text-2" id="text-org8c69c8d">
<p>
We saw previously that
</p>
<ul class="org-ul">
<li>[ 1 &xi;<sup>k</sup> &xi;<sup>2k</sup> &#x2026; &xi;<sup>(n-1)k</sup> ] [ 1 1 1 &#x2026; 1]<sup>T</sup>= 0</li>
</ul>
<p>
But now that we can take inner products of complex vectors we can go a few steps further. Given different values of <i>k</i> - here I choose <i>r</i> and <i>s</i>
</p>

<ul class="org-ul">
<li>[ 1 &xi;<sup>r</sup> &xi;<sup>2r</sup> &#x2026; &xi;<sup>(n-1)r</sup> ] [ 1 &xi;<sup>s</sup> &xi;<sup>2s</sup> &#x2026; &xi;<sup>(n-1)s</sup> ]<sup>*</sup></li>
<li>[ 1 &xi;<sup>r</sup> &xi;<sup>2r</sup> &#x2026; &xi;<sup>(n-1)r</sup> ] [ 1 &xi;<sup>-s</sup> &xi;<sup>-2s</sup> &#x2026; &xi;<sup>-(n-1)s</sup> ]<sup>T</sup></li>
<li>1*1 + &xi;<sup>r</sup>*&xi;<sup>-s</sup> + &xi;<sup>2r</sup>*&xi;<sup>-2s</sup> + &#x2026; + &xi;<sup>(n-2)r</sup>&xi;<sup>-(n-2)s</sup>} + &xi;<sup>(n-1)r</sup>&xi;<sup>-(n-1)s</sup></li>
<li>1 + &xi;<sup>r-s</sup> + &xi;<sup>2(r-s)</sup> + &#x2026; + &xi;<sup>(n-2)(r-s)</sup> + &xi;<sup>(n-1)(r-s)</sup></li>
</ul>
<p>
We can factor out the (r-s) exponent
</p>
<ul class="org-ul">
<li>(1<sup>1/(r-s)</sup> + &xi;<sup>1</sup> + &xi;<sup>2</sup> + &#x2026; + &xi;<sup>n-2</sup> + &xi;<sup>n-1</sup>)<sup>r-s</sup></li>
<li>(1 + &xi;<sup>1</sup> + &xi;<sup>2</sup> + &#x2026; + &xi;<sup>n-2</sup> + &xi;<sup>n-1</sup>)<sup>r-s</sup></li>
</ul>
<p>
And notice that the inner sum is the fourier series and therefore equal to <i>0</i>. So the inner product of two Fourier series is also equal to zero <b>except</b> when <i>r=s</i> b/c <i>r=s</i> is the case we need for the 2-norm!
</p>
<ul class="org-ul">
<li>[ 1 &xi;<sup>k</sup> &xi;<sup>2k</sup> &#x2026; &xi;<sup>(n-1)k</sup> ]  [ 1 &xi;<sup>k</sup> &xi;<sup>2k</sup> &#x2026; &xi;<sup>(n-1)k</sup> ]<sup>*</sup></li>
<li>1*1 + &xi;<sup>k</sup>&xi;<sup>-k</sup> + &xi;<sup>2k</sup>&xi;<sup>-2k</sup> + &#x2026; + &xi;<sup>(n-1)k</sup> &xi;<sup>-(n-1)k</sup></li>
<li>1*1 + &xi;<sup>0</sup> + &xi;<sup>0</sup> + &#x2026; + &xi;<sup>0</sup></li>
<li>1 + 1 + 1 + &#x2026; + 1</li>
</ul>
<p>
You could also skip the math and observe that this is the sum of the 2-norms of the roots of unity. There are <i>n</i> terms and each one is necessarily of length <i>1</i>. Either way, the answer will always be <i>n</i> no matter what <i>k</i> you choose
and therefore the 2-norm/length all all fourier vectors is <i>n<sup>1/2</sup></i>
</p>

<p>
It's important to note that if you drop all the complex terms none of this works! You can't construct mutually orthogonal vectors out of purely real sine/cosine waves
</p>
</div>
</div>

<div id="outline-container-orgd91bc90" class="outline-2">
<h2 id="orgd91bc90">Fourier Matrix</h2>
<div class="outline-text-2" id="text-orgd91bc90">
<p>
We've just shown that the fourier vectors are orthogonal as long as the <i>k</i>'s are different. So the next step is self evident. We just choose <i>k</i>'s 1 through <i>n</i> and slap them together into a fourier matrix <b>F</b> and get ourselves an orthogonal basis:
</p>
<table>


<colgroup>
<col  class="org-right">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">1</td>
<td class="org-left">1</td>
<td class="org-left">1</td>
<td class="org-left">..</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">&xi;</td>
<td class="org-left">&xi;<sup>2</sup></td>
<td class="org-left">&xi;<sup>3</sup></td>
<td class="org-left">..</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">&xi;<sup>2</sup></td>
<td class="org-left">&xi;<sup>4</sup></td>
<td class="org-left">&xi;<sup>6</sup></td>
<td class="org-left">..</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">&xi;<sup>3</sup></td>
<td class="org-left">&xi;<sup>6</sup></td>
<td class="org-left">&xi;<sup>9</sup></td>
<td class="org-left">..</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&#x2026;</td>
<td class="org-left">..</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">&xi;<sup>n-1</sup></td>
<td class="org-left">&xi;<sup>n-2</sup></td>
<td class="org-left">&#x2026;</td>
<td class="org-left">&xi;</td>
</tr>
</tbody>
</table>

<p>
1 - Each column represents different exponents of this starting <b>n<sup>th</sup> root of unity</b> that we called &xi;. The second column makes one full rotation, the third makes 2 rotations (hence there will be a <i>1</i> in the middle), the fourth will make 3 rotations and have 2 <i>1</i>'s, etc.
</p>

<p>
2 - Looking at the real components of the columns - there is one constant component (the first column) and then <i>n</i> samples of the <i>cosine</i> function over one oscillation for the second column, <i>n</i> samples over 2 periods for the 3rd column, <i>n</i> samples over 3 periods.. etc.  If your input is over 1 second then this maps to a cosine function of 1Hz, 2Hz, 3Hz, etc.. The complex component will look similar, but with the <i>sine</i> function <b>Note</b>: that the real components alone are no orthogonal. You can't drop the imaginary parts b/c of how they come in in the complex conjugate products of the inner products
</p>

<p>
3 - Since each series (irrespective of the <i>k</i> exponent) has length <i>n<sup>1/2</sup></i>, all the columns of <b>F</b> can be normalized in one go by dividing the matrix by <i>n<sup>1/2</sup></i>. The resulting matrix <b>(1/n<sup>1/2</sup>)F</b> is now ever better b/c it's orthonormal/unitary. Therefore its inverse is just its Hermitian transpose.
</p>

<ul class="org-ul">
<li>[(1/n<sup>1/2</sup>)F]<sup>-1</sup> = [(1/n<sup>1/2</sup>)F]<sup>*</sup></li>
<li>F<sup>-1</sup> = (1/n)F<sup>*</sup></li>
</ul>
<p>
Looking at <i>F*F<sup>-1</sup></i>, the diagonal elements will be the normalized vector norms of the fourier vectors (<i>1</i>'s), and the off-diagonal elements are all inner products of orthogonal fourier vectors (<i>0</i>'s)
</p>
</div>
</div>

<div id="outline-container-orgf4121b8" class="outline-2">
<h2 id="orgf4121b8">Frequency Space?</h2>
<div class="outline-text-2" id="text-orgf4121b8">
<p>
We constructed a very convenient basis that's easily invertible and independent of the input and we can now easily move to the basis and back but it's not exactly what one would imagine as "frequency space" and a few things are unresolved
</p>
</div>

<div id="outline-container-orgaf2d678" class="outline-3">
<h3 id="orgaf2d678">How does a sinusoidal look in this basis?</h3>
<div class="outline-text-3" id="text-orgaf2d678">
<p>
Reusing the trigonometric identities: 
</p>
<ul class="org-ul">
<li>sin(-&theta;) = -sin(&theta;)</li>
<li>cos(-&theta;) = cos(&theta;)</li>
</ul>
<p>
We can carefully pair Euler functions to get back sinusoids
</p>
<ul class="org-ul">
<li><b>[e<sup>i&theta;</sup> + e<sup>-i&theta;</sup>]/2</b> = [cos(&theta;) + isin(&theta;) + cos(-&theta;) + isin(-&theta;)]/2 = <b>cos(&theta;)</b></li>
<li><b>[e<sup>i&theta;</sup> - e<sup>-i&theta;</sup>]/2i</b> = [cos(&theta;) + isin(&theta;) - cos(-&theta;) - isin(-&theta;)]/2i = <b>sin(&theta;)</b></li>
</ul>
<p>
If we put in <i>-2&pi;&phi;/n</i> for <i>&theta;</i>  we back our familiar exponents:
</p>
<ul class="org-ul">
<li>cos(2&pi;&phi;/n) = [&xi;<sup>-&phi;</sup> + &xi;<sup>&phi;</sup>]/2</li>
<li>cos(2&pi;&phi;) = n*[&xi;<sup>-&phi;</sup> + &xi;<sup>&phi;</sup>]/2</li>
<li>sin(2&pi;&phi;/n) = [&xi;<sup>-&phi;</sup> - &xi;<sup>&phi;</sup>]/2i</li>
<li>sin(2&pi;&phi;) = n*[&xi;<sup>-&phi;</sup> - &xi;<sup>&phi;</sup>]/2i</li>
</ul>
<p>
This is a bit goofy b/c we haven't have negative <i>k</i> values. Fortunately b/c these are cyclical functions:
</p>
<ul class="org-ul">
<li>sin(-&theta;) = sin(2&pi; - &theta;)</li>
<li>cos(-&theta;) = cos(2&pi; - &theta;)</li>
<li>e<sup>-i&theta;</sup> = e<sup>i(2&pi;-&theta;)</sup></li>
<li>&xi;<sup>-k</sup> = &xi;<sup>n-k</sup></li>
</ul>
<p>
So we can rewrite is as:
</p>
<ul class="org-ul">
<li>cos(2&pi;&phi;) = n*[&xi;<sup>n-&phi;</sup> + &xi;<sup>&phi;</sup>]/2</li>
<li>sin(2&pi;&phi;) = n*[&xi;<sup>n-&phi;</sup> - &xi;<sup>&phi;</sup>]/2i</li>
</ul>
<p>
If <i>&phi;</i> is equal to a <i>k</i> value, then this will be equal to basis vectors in our fourier matrix.
</p>

<p>
For instance if &phi; = 3 we can pick an <i>x</i>
</p>
<ul class="org-ul">
<li>x = [ 0 0 n/2 0 0 .. 0 0 n/2 0 0]<sub>1,n</sub></li>
</ul>
<p>
So that:
</p>
<ul class="org-ul">
<li>cos(2&pi; * 3) = F<sup>*</sup>x<sup>T</sup></li>
</ul>

<p>
Similarly with the sine function, except:
</p>
<ul class="org-ul">
<li>y = [ 0 0 -n/2i 0 0 .. 0 0 n/2i 0 0]<sub>1,n</sub></li>
</ul>
<p>
So that:
</p>
<ul class="org-ul">
<li>sin(2&pi; * 3) = F<sup>*</sup>y<sup>T</sup></li>
</ul>

<p>
Note two things about these Fourier coordinate vectors:
</p>
<ul class="org-ul">
<li>the real components are generating <i>cosine</i> functions</li>
<li>the <i>n<sup>th</sup></i> and <i>n-&phi;</i> components are equal</li>
<li>the imaginary components are generating <i>sine</i> function</li>
<li>the <i>n<sup>th</sup></i> and <i>n-&phi;</i> components are negatives of each other</li>
</ul>

<p>
Because of this symmetry the first n/2 terms tell us everything about oscillating components of our input. 
</p>

<blockquote>
<p>
<b>Note</b> This doesn't represent a loss of information. The input had <b>n</b> real values the output has <b>n/2</b> complex coordinates (each made of 2 values)
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org6e18e17" class="outline-3">
<h3 id="org6e18e17">How does a phase shift look in this basis?</h3>
<div class="outline-text-3" id="text-org6e18e17">
<p>
Thanks to <b>harmonic addition</b> we can add sines and cosines of the same frequency to make phase shifted sinusoids
</p>
<ul class="org-ul">
<li>&alpha; sin(x) + &beta; cos(x) = &gamma; sin(x+&theta;)</li>
<li>&gamma; = &radic;[a<sup>2</sup>+b<sup>2</sup>]</li>
<li>&theta; = atan(&beta;/&alpha;)</li>
</ul>

<p>
The &beta; values are encoded in the real part of the fourier coordinates and our &alpha; values are in the imaginary part. So look at just the first <i>n/2</i> coordinates' complex values we can reinterpret these values as a phase shifted sine waves
</p>
</div>
</div>
<div id="outline-container-org48a6b11" class="outline-3">
<h3 id="org48a6b11">How does a frequency who's period isn't a whole fraction of the sample rate come out in this basis?</h3>
<div class="outline-text-3" id="text-org48a6b11">
<p>
How about if <i>&phi;</i> is not equal to a <i>k</i> value?
</p>
</div>
</div>
</div>
</div>
</body>
</html>
